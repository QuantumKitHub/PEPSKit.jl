<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Simple update for the Fermi-Hubbard model at half-filling · PEPSKit.jl</title><meta name="title" content="Simple update for the Fermi-Hubbard model at half-filling · PEPSKit.jl"/><meta property="og:title" content="Simple update for the Fermi-Hubbard model at half-filling · PEPSKit.jl"/><meta property="twitter:title" content="Simple update for the Fermi-Hubbard model at half-filling · PEPSKit.jl"/><meta name="description" content="Documentation for PEPSKit.jl."/><meta property="og:description" content="Documentation for PEPSKit.jl."/><meta property="twitter:description" content="Documentation for PEPSKit.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="PEPSKit.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PEPSKit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../man/models/">Models</a></li><li><a class="tocitem" href="../../man/multithreading/">Multithreading</a></li><li><a class="tocitem" href="../../man/precompilation/">Precompilation using PrecompileTools.jl</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../">Overview</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Optimization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../heisenberg/">Optimizing the 2D Heisenberg model</a></li><li><a class="tocitem" href="../bose_hubbard/">Optimizing the <span>$U(1)$</span>-symmetric Bose-Hubbard model</a></li><li><a class="tocitem" href="../xxz/">Néel order in the <span>$U(1)$</span>-symmetric XXZ model</a></li><li><a class="tocitem" href="../fermi_hubbard/">Fermi-Hubbard model with <span>$f\mathbb{Z}_2 \boxtimes U(1)$</span> symmetry, at large <span>$U$</span> and half-filling</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Time Evolution</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../heisenberg_su/">Simple update for the Heisenberg model</a></li><li class="is-active"><a class="tocitem" href>Simple update for the Fermi-Hubbard model at half-filling</a><ul class="internal"><li><a class="tocitem" href="#Defining-the-Hamiltonian"><span>Defining the Hamiltonian</span></a></li><li><a class="tocitem" href="#Running-the-simple-update-algorithm"><span>Running the simple update algorithm</span></a></li><li><a class="tocitem" href="#Computing-the-ground-state-energy"><span>Computing the ground-state energy</span></a></li></ul></li><li><a class="tocitem" href="../j1j2_su/">Three-site simple update for the <span>$J_1$</span>-<span>$J_2$</span> model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Partition Functions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../2d_ising_partition_function/">The 2D classical Ising model using CTMRG</a></li><li><a class="tocitem" href="../3d_ising_partition_function/">The 3D classical Ising model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Boundary MPS</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../boundary_mps/">Boundary MPS contractions of 2D networks</a></li></ul></li></ul></li><li><a class="tocitem" href="../../lib/lib/">Library</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li><a class="is-disabled">Time Evolution</a></li><li class="is-active"><a href>Simple update for the Fermi-Hubbard model at half-filling</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Simple update for the Fermi-Hubbard model at half-filling</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumKitHub/PEPSKit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumKitHub/PEPSKit.jl/blob/master/examples/hubbard_su/main.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p><a href="https://mybinder.org/v2/gh/QuantumKitHub/PEPSKit.jl/gh-pages?filepath=dev/examples/hubbard_su/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/QuantumKitHub/PEPSKit.jl/blob/gh-pages/dev/examples/hubbard_su/main.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/QuantumKitHub/PEPSKit.jl/examples/tree/gh-pages/dev/examples/hubbard_su"><img src="https://img.shields.io/badge/download-project-orange" alt/></a></p><h1 id="Simple-update-for-the-Fermi-Hubbard-model-at-half-filling"><a class="docs-heading-anchor" href="#Simple-update-for-the-Fermi-Hubbard-model-at-half-filling">Simple update for the Fermi-Hubbard model at half-filling</a><a id="Simple-update-for-the-Fermi-Hubbard-model-at-half-filling-1"></a><a class="docs-heading-anchor-permalink" href="#Simple-update-for-the-Fermi-Hubbard-model-at-half-filling" title="Permalink"></a></h1><p>Once again, we consider the Hubbard model but this time we obtain the ground-state PEPS by imaginary time evolution. In particular, we&#39;ll use the <a href="../../lib/lib/#PEPSKit.SimpleUpdate"><code>SimpleUpdate</code></a> algorithm. As a reminder, we define the Hubbard model as</p><p class="math-container">\[H = -t \sum_{\langle i,j \rangle} \sum_{\sigma} \left( c_{i,\sigma}^+ c_{j,\sigma}^- -
c_{i,\sigma}^- c_{j,\sigma}^+ \right) + U \sum_i n_{i,\uparrow}n_{i,\downarrow} - \mu \sum_i n_i\]</p><p>with <span>$\sigma \in \{\uparrow,\downarrow\}$</span> and <span>$n_{i,\sigma} = c_{i,\sigma}^+ c_{i,\sigma}^-$</span>.</p><p>Let&#39;s get started by seeding the RNG and importing the required modules:</p><pre><code class="language-julia hljs">using Random
using TensorKit, PEPSKit
Random.seed!(12329348592498);</code></pre><h2 id="Defining-the-Hamiltonian"><a class="docs-heading-anchor" href="#Defining-the-Hamiltonian">Defining the Hamiltonian</a><a id="Defining-the-Hamiltonian-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-the-Hamiltonian" title="Permalink"></a></h2><p>First, we define the Hubbard model at <span>$t=1$</span> hopping and <span>$U=6$</span> using <code>Trivial</code> sectors for the particle and spin symmetries, and set <span>$\mu = U/2$</span> for half-filling. The model will be constructed on a <span>$2 \times 2$</span> unit cell, so we have:</p><pre><code class="language-julia hljs">t = 1
U = 6
Nr, Nc = 2, 2
H = hubbard_model(Float64, Trivial, Trivial, InfiniteSquare(Nr, Nc); t, U, mu = U / 2);
physical_space = Vect[fℤ₂](0 =&gt; 2, 1 =&gt; 2);</code></pre><h2 id="Running-the-simple-update-algorithm"><a class="docs-heading-anchor" href="#Running-the-simple-update-algorithm">Running the simple update algorithm</a><a id="Running-the-simple-update-algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Running-the-simple-update-algorithm" title="Permalink"></a></h2><p>Suppose the goal is to use imaginary-time simple update to optimize a PEPS with bond dimension D = 8, and <span>$2 \times 2$</span> unit cells. For a challenging model like the Hubbard model, a naive evolution starting from a random PEPS at D = 8 will almost always produce a sub-optimal state. In this example, we shall demonstrate some common practices to improve SU result.</p><p>First, we shall use a small D for the random PEPS initialization, which is chosen as 4 here. For convenience, here we work with real tensors with <code>Float64</code> entries. The bond weights are still initialized as identity matrices.</p><pre><code class="language-julia hljs">virtual_space = Vect[fℤ₂](0 =&gt; 2, 1 =&gt; 2)
peps = InfinitePEPS(rand, Float64, physical_space, virtual_space; unitcell = (Nr, Nc));
wts = SUWeight(peps);</code></pre><p>Starting from the random state, we first use a relatively large evolution time step <code>dt = 1e-2</code>. After convergence at D = 4, to avoid stucking at some bad local minimum, we first increase D to 12, and drop it back to D = 8 after a while. Afterwards, we keep D = 8 and gradually decrease <code>dt</code> to <code>1e-4</code> to improve convergence.</p><pre><code class="language-julia hljs">dts = [1.0e-2, 1.0e-2, 1.0e-3, 4.0e-4, 1.0e-4]
tols = [1.0e-7, 1.0e-7, 1.0e-8, 1.0e-8, 1.0e-8]
Ds = [4, 12, 8, 8, 8]
maxiter = 20000

for (dt, tol, Dbond) in zip(dts, tols, Ds)
    trunc = truncerror(; atol=1.0e-10) &amp; truncrank(Dbond)
    alg = SimpleUpdate(dt, tol, maxiter, trunc)
    global peps, wts, = simpleupdate(
        peps, H, alg, wts; bipartite = false, check_interval = 2000
    )
end</code></pre><pre><code class="nohighlight hljs">[ Info: Space of x-weight at [1, 1] = Vect[FermionParity](0=&gt;2, 1=&gt;2)
[ Info: SU iter 1      :  dt = 1e-02,  weight diff = 1.316e+00,  time = 27.486 sec
[ Info: Space of x-weight at [1, 1] = Vect[FermionParity](0=&gt;2, 1=&gt;2)
[ Info: SU conv 1045   :  dt = 1e-02,  weight diff = 9.843e-08,  time = 34.956 sec
[ Info: Space of x-weight at [1, 1] = Vect[FermionParity](0=&gt;6, 1=&gt;6)
[ Info: SU iter 1      :  dt = 1e-02,  weight diff = 6.459e-06,  time = 0.077 sec
[ Info: Space of x-weight at [1, 1] = Vect[FermionParity](0=&gt;6, 1=&gt;6)
[ Info: SU conv 584    :  dt = 1e-02,  weight diff = 9.946e-08,  time = 42.322 sec
[ Info: Space of x-weight at [1, 1] = Vect[FermionParity](0=&gt;3, 1=&gt;5)
[ Info: SU iter 1      :  dt = 1e-03,  weight diff = 5.245e-03,  time = 0.235 sec
[ Info: Space of x-weight at [1, 1] = Vect[FermionParity](0=&gt;3, 1=&gt;5)
[ Info: SU iter 2000   :  dt = 1e-03,  weight diff = 1.418e-07,  time = 0.018 sec
[ Info: Space of x-weight at [1, 1] = Vect[FermionParity](0=&gt;3, 1=&gt;5)
[ Info: SU conv 3791   :  dt = 1e-03,  weight diff = 9.990e-09,  time = 78.783 sec
[ Info: Space of x-weight at [1, 1] = Vect[FermionParity](0=&gt;3, 1=&gt;5)
[ Info: SU iter 1      :  dt = 4e-04,  weight diff = 3.256e-04,  time = 0.018 sec
[ Info: Space of x-weight at [1, 1] = Vect[FermionParity](0=&gt;3, 1=&gt;5)
[ Info: SU iter 2000   :  dt = 4e-04,  weight diff = 1.888e-08,  time = 0.024 sec
[ Info: Space of x-weight at [1, 1] = Vect[FermionParity](0=&gt;3, 1=&gt;5)
[ Info: SU conv 3034   :  dt = 4e-04,  weight diff = 9.997e-09,  time = 62.113 sec
[ Info: Space of x-weight at [1, 1] = Vect[FermionParity](0=&gt;3, 1=&gt;5)
[ Info: SU iter 1      :  dt = 1e-04,  weight diff = 1.627e-04,  time = 0.024 sec
[ Info: Space of x-weight at [1, 1] = Vect[FermionParity](0=&gt;3, 1=&gt;5)
[ Info: SU iter 2000   :  dt = 1e-04,  weight diff = 1.532e-08,  time = 0.018 sec
[ Info: Space of x-weight at [1, 1] = Vect[FermionParity](0=&gt;3, 1=&gt;5)
[ Info: SU conv 2916   :  dt = 1e-04,  weight diff = 9.997e-09,  time = 59.560 sec
</code></pre><h2 id="Computing-the-ground-state-energy"><a class="docs-heading-anchor" href="#Computing-the-ground-state-energy">Computing the ground-state energy</a><a id="Computing-the-ground-state-energy-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-the-ground-state-energy" title="Permalink"></a></h2><p>In order to compute the energy expectation value with evolved PEPS, we need to converge a CTMRG environment on it. We first converge an environment with a small enviroment dimension and then use that to initialize another run with bigger environment dimension. We&#39;ll use <code>trunc=truncrank(χ)</code> for that such that the dimension is increased during the second CTMRG run:</p><pre><code class="language-julia hljs">χenv₀, χenv = 6, 16
env_space = Vect[fℤ₂](0 =&gt; χenv₀ / 2, 1 =&gt; χenv₀ / 2)
normalize!.(peps.A, Inf)
env = CTMRGEnv(rand, Float64, peps, env_space)
for χ in [χenv₀, χenv]
    global env, = leading_boundary(
        env, peps; alg = :sequential, tol = 1.0e-8, maxiter = 50, trunc = truncrank(χ)
    )
end</code></pre><pre><code class="nohighlight hljs">[ Info: CTMRG init:	obj = +4.034556135739e-13	err = 1.0000e+00
┌ Warning: CTMRG cancel 50:	obj = +1.777694990783e+00	err = 2.1447151954e-06	time = 18.75 sec
└ @ PEPSKit ~/PEPSKit.jl/src/algorithms/ctmrg/ctmrg.jl:152
[ Info: CTMRG init:	obj = +1.777694990783e+00	err = 1.0000e+00
[ Info: CTMRG conv 7:	obj = +1.781063096355e+00	err = 3.5793745596e-10	time = 21.32 sec
</code></pre><p>We measure the energy by computing the <code>H</code> expectation value, where we have to make sure to normalize with respect to the unit cell to obtain the energy per site:</p><pre><code class="language-julia hljs">E = expectation_value(peps, H, env) / (Nr * Nc)
@show E;</code></pre><pre><code class="nohighlight hljs">E = -3.652497562261351
</code></pre><p>Finally, we can compare the obtained ground-state energy against the literature, namely the QMC estimates from <a href="../../references/#qin_benchmark_2016">Qin et al.</a>. We find that the results generally agree:</p><pre><code class="language-julia hljs">Es_exact = Dict(0 =&gt; -1.62, 2 =&gt; -0.176, 4 =&gt; 0.8603, 6 =&gt; -0.6567, 8 =&gt; -0.5243)
E_exact = Es_exact[U] - U / 2
@show (E - E_exact) / abs(E_exact);</code></pre><pre><code class="nohighlight hljs">(E - E_exact) / abs(E_exact) = 0.001149243235334783
</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../heisenberg_su/">« Simple update for the Heisenberg model</a><a class="docs-footer-nextpage" href="../j1j2_su/">Three-site simple update for the <span>$J_1$</span>-<span>$J_2$</span> model »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Thursday 30 October 2025 10:22">Thursday 30 October 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
